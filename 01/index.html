<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <title>JS 01</title>
  </head>
  <body>
    <div class="bg">
      <div class="key" data-key="65">
        <div class="title">A</div>
        <div class="description">CLAP</div>
        <audio data-key="65" src="./raw/sounds/clap.wav"></audio>
      </div>
      <div class="key" data-key="83">
        <div class="title">S</div>
        <div class="description">HIHAT</div>
        <audio data-key="83" src="./raw/sounds/hihat.wav"></audio>
      </div>
      <div class="key" data-key="68">
        <div class="title">D</div>
        <div class="description">KICK</div>
        <audio data-key="68" src="./raw/sounds/kick.wav"></audio>
      </div>
      <div class="key" data-key="70">
        <div class="title">F</div>
        <div class="description">OPENHAT</div>
        <audio data-key="70" src="./raw/sounds/openhat.wav"></audio>
      </div>
      <div class="key" data-key="71">
        <div class="title">G</div>
        <div class="description">BOOM</div>
        <audio data-key="71" src="./raw/sounds/boom.wav"></audio>
      </div>
      <div class="key" data-key="72">
        <div class="title">H</div>
        <div class="description">RIDE</div>
        <audio data-key="72" src="./raw/sounds/ride.wav"></audio>
      </div>
      <div class="key" data-key="74">
        <div class="title">J</div>
        <div class="description">SNARE</div>
        <audio data-key="74" src="./raw/sounds/snare.wav"></audio>
      </div>
      <div class="key" data-key="75">
        <div class="title">K</div>
        <div class="description">TOM</div>
        <audio data-key="75" src="./raw/sounds/tom.wav"></audio>
      </div>
      <div class="key" data-key="76">
        <div class="title">L</div>
        <div class="description">TINK</div>
        <audio data-key="76" src="./raw/sounds/tink.wav"></audio>
      </div>
    </div>
    <script>
      ;(function () {
        document.querySelector('body').addEventListener('keydown', playAudio)

        document.querySelectorAll('div.key').forEach((item) =>
          item.addEventListener('transitionend', (e) => {
            if (e.propertyName !== 'transfrom') return false
            console.log(e)
          })
        )

        function playAudio(e) {
          const targetAudio = document.querySelector(
            `audio[data-key="${e.keyCode}"]`
          )
          const targetKey = document.querySelector(
            `div[data-key="${e.keyCode}"]`
          )
          if (!targetAudio) return false
          targetKey.classList.add('playing')
          targetAudio.currentTime = 0
          targetAudio.play()
        }
      })()
    </script>
  </body>
</html>
